{"version":3,"names":["React","useCallback","useEffect","useRef","RTCPeerConnection","RTCIceCandidate","RTCSessionDescription","MediaStream","MediaStreamTrack","mediaDevices","RTCView","useAntMedia","params","url","mediaConstraints","callbackError","callback","peer_connection_config","debug","onlyDataChannel","adaptorRef","localStream","remotePeerConnection","current","remotePeerConnectionStats","remoteDescriptionSet","iceCandidateList","config","playStreamIds","pingTimer","idMapping","Array","closePeerConnection","streamId","console","log","peerConnection","dataChannel","close","signalingState","playStreamIndex","indexOf","splice","clearInterval","timerId","iceCandidateReceived","event","candidate","jsCmd","command","label","sdpMLineIndex","id","sdpMid","ws","sendJson","onTrack","dataObj","stream","streams","track","trackId","undefined","transceiver","mid","call","initDataChannel","onerror","error","obj","readyState","onmessage","onopen","onclose","initPeerConnection","dataChannelMode","closedStreamId","iceServers","includes","getTracks","forEach","addTrack","onicecandidate","ontrack","ondatachannel","channel","dataChannelOptions","ordered","dataChannelPeer","createDataChannel","err","message","gotDescription","configuration","setLocalDescription","type","sdp","startPublishing","createOffer","stack","addIceCandidate","takeConfiguration","typeOfConfiguration","idMap","conf","replace","isTypeOffer","setRemoteDescription","length","Object","keys","i","configur","createAnswer","toString","takeCandidate","idOfTheStream","tmpLabel","tmpCandidate","candidateSdp","index","findIndex","JSON","stringify","key","push","WebSocket","dt","send","getDevices","getUserMedia","then","catch","setPingTimer","e","data","parse","definition","clearPingTimer","code","reason","publish","token","subscriberId","subscriberCode","streamName","mainTrack","metaData","video","audio","getVideoTracks","getAudioTracks","play","room","enableTracks","viewerInfo","stop","join","leave","muteLocalMic","enabled","unmuteLocalMic","setLocalMicVolume","volume","_setVolume","setRemoteAudioVolume","roomName","_remoteStreams","audioTrackID","getTrackById","muteRemoteAudio","unmuteRemoteAudio","getRoomInfo","setInterval","peerMessage","deviceArray","devices","enumerateDevices","map","device","ondevicechange","sendData","turnOffLocalCamera","turnOnLocalCamera","turnOffRemoteCamera","videoTrackID","turnOnRemoteCamera","switchCamera","_switchCamera","rtc_view","customStyles","width","height","alignSelf","objectFit","mediaStream","toURL","props","streamURL","style","createElement"],"sources":["index.tsx"],"sourcesContent":["import React, {\n  useCallback,\n  useEffect,\n  useRef,\n  MutableRefObject,\n} from 'react';\n\nimport {\n  RTCPeerConnection,\n  RTCIceCandidate,\n  RTCSessionDescription,\n  MediaStream,\n  MediaStreamTrack,\n  mediaDevices,\n  RTCView,\n} from 'react-native-webrtc';\n\n//Interfaces\nexport interface Params {\n  url: string;\n  mediaConstraints: any;\n  callback(this: Adaptor, message: string, data?: any): void;\n  callbackError?: (errorMessage: string, data?: any) => void;\n  peer_connection_config?: any;\n  debug?: boolean;\n  onlyDataChannel?: boolean;\n}\nexport interface RemoteStreams {\n  [key: string]: MediaStream;\n}\n\nexport interface Adaptor {\n  publish: (streamId: string, token?: string, subscriberId?:string , subscriberCode?: string, streamName?: string, mainTrack?:string, metaData?:string) => void;\n  play: (streamId: string, token?: string, room?: string , enableTracks?: MediaStream[],subscriberId?:string , subscriberCode?: string,  metaData?:string) => void;\n  stop: (streamId: string) => void;\n  join: (streamId: string) => void;\n  leave: (streamId: string) => void;\n  getRoomInfo: (room: string, streamId?: string) => void;\n  initPeerConnection: (\n    streamId: string,\n    dataChannelMode: 'publish' | 'play' | 'peer'\n  ) => Promise<void>;\n  localStream: MutableRefObject<MediaStream | null>;\n  peerMessage: (streamId: string, definition: any, data: any) => void;\n  sendData: (streamId: string, message: string) => void;\n  muteLocalMic: () => void;\n  unmuteLocalMic: () => void;\n  setLocalMicVolume: (volume: number) => void;\n  setRemoteAudioVolume: (volume: number, streamId: string, roomName: string|undefined) => void;\n  muteRemoteAudio: (streamId: string, roomName: string|undefined) => void;\n  unmuteRemoteAudio: (streamId: string, roomName: string|undefined) => void;\n  turnOffLocalCamera: () => void;\n  turnOnLocalCamera: () => void;\n  turnOffRemoteCamera: () => void;\n  turnOnRemoteCamera: () => void;\n  switchCamera: () => void;\n  getDevices: () => Promise<any>;\n}\nexport interface RemotePeerConnection {\n  [key: string]: RTCPeerConnection;\n}\nexport interface RemotePeerConnectionStats {\n  [key: string]: { timerId: number };\n}\n\nexport interface RemoteDescriptionSet {\n  [key: string]: boolean;\n}\nexport interface IceCandidateList {\n  [key: string]: RTCIceCandidate[];\n}\nexport interface Sender {\n  track: MediaStreamTrack;\n  getParameters: () => {\n    encodings?: any;\n  };\n  setParameters: (data: any) => Record<string, unknown>;\n}\n//useAntMedia main adaptor function\nexport function useAntMedia(params: Params) {\n\n  const {\n    url,\n    mediaConstraints,\n    callbackError,\n    callback,\n    peer_connection_config,\n    debug,\n    onlyDataChannel,\n  } = params;\n\n  const adaptorRef: any = useRef<null | Adaptor>(null);\n\n  let localStream: any = useRef(null);\n\n  const remotePeerConnection = useRef<RemotePeerConnection>({}).current;\n  const remotePeerConnectionStats = useRef<RemotePeerConnectionStats>(\n    {}\n  ).current;\n\n  const remoteDescriptionSet = useRef<RemoteDescriptionSet>({}).current;\n  const iceCandidateList = useRef<IceCandidateList>({}).current;\n\n  const config: any = peer_connection_config;\n\n  const playStreamIds = useRef<string[]>([]).current;\n\n  var pingTimer: any = -1;\n\n  var idMapping = new Array();\n\n  const closePeerConnection = useCallback(\n    (streamId: string) => {\n      if (debug) console.log('closePeerConnection');\n\n      var peerConnection: RTCPeerConnection = remotePeerConnection[streamId];\n\n      if (peerConnection != null) {\n        delete remotePeerConnection[streamId];\n\n        // @ts-ignore\n        if (peerConnection.dataChannel != null) {\n          // @ts-ignore\n          peerConnection.dataChannel.close();\n        }\n        if (peerConnection.signalingState !== 'closed') {\n          peerConnection.close();\n        }\n        const playStreamIndex = playStreamIds.indexOf(streamId);\n\n        if (playStreamIndex !== -1) {\n          playStreamIds.splice(playStreamIndex, 1);\n        }\n      }\n\n      if (remotePeerConnectionStats[streamId] != null) {\n        clearInterval(remotePeerConnectionStats[streamId].timerId);\n        delete remotePeerConnectionStats[streamId];\n      }\n    },\n    [playStreamIds, remotePeerConnection, remotePeerConnectionStats]\n  );\n\n  const iceCandidateReceived = useCallback(\n    (event: any, streamId: string) => {\n      if (event.candidate) {\n        const jsCmd = {\n          command: 'takeCandidate',\n          streamId,\n          label: event.candidate.sdpMLineIndex,\n          id: event.candidate.sdpMid,\n          candidate: event.candidate.candidate,\n        };\n\n        if (ws) ws.sendJson(jsCmd);\n      }\n    },\n    [ws]\n  );\n\n  const onTrack = useCallback(\n    (event: any, streamId: any) => {\n        const dataObj = {\n          stream: event.streams[0],\n          track: event.track,\n          streamId: streamId,\n          trackId: idMapping[streamId] != undefined? idMapping[streamId][event.transceiver.mid]:undefined,\n        }\n        if (adaptorRef.current) {\n          callback.call(adaptorRef.current, 'newStreamAvailable', dataObj);\n          callback.call(adaptorRef.current, 'newTrackAvailable', dataObj);\n        }\n    },\n    [callback]\n  );\n\n  const initDataChannel = useCallback((streamId: string, dataChannel: any) => {\n    dataChannel.onerror = (error: any) => {\n      console.log('Data Channel Error:', error);\n      const obj = {\n        streamId: streamId,\n        error: error,\n      };\n      console.log('channel status: ', dataChannel.readyState);\n      if (dataChannel.readyState !== 'closed' && callbackError) {\n        callbackError('data_channel_error', obj);\n      }\n    };\n\n    dataChannel.onmessage = (event: any) => {\n      const obj = {\n        streamId: streamId,\n        event: event,\n      };\n      if (callback && adaptorRef.current)\n        callback.call(adaptorRef.current, 'data_received', obj);\n    };\n\n    dataChannel.onopen = () => {\n      // @ts-ignore\n      remotePeerConnection[streamId].dataChannel = dataChannel;\n      console.log('Data channel is opened');\n      if (callback && adaptorRef.current)\n        callback.call(adaptorRef.current, 'data_channel_opened', streamId);\n    };\n\n    dataChannel.onclose = () => {\n      console.log('Data channel is closed');\n      if (callback && adaptorRef.current)\n        callback.call(adaptorRef.current, 'data_channel_closed', streamId);\n    };\n  }, []);\n\n  const initPeerConnection = useCallback(\n    async (streamId: string, dataChannelMode: 'publish' | 'play' | 'peer') => {\n      if (debug) console.log('in initPeerConnection');\n\n      if (remotePeerConnection[streamId] == null) {\n        const closedStreamId = streamId;\n        remotePeerConnection[streamId] = new RTCPeerConnection(config || { iceServers: [] });\n        remoteDescriptionSet[streamId] = false;\n        iceCandidateList[streamId] = [];\n\n        if (!playStreamIds.includes(streamId) && localStream.current) {\n          // @ts-ignore\n          localStream.current.getTracks().forEach((track) => {\n            remotePeerConnection[streamId].addTrack(track, localStream.current);\n//            localStream.current.getTracks().forEach((track: MediaStreamTrack) => { remotePeerConnection[streamId].addTrack(track, localStream.current); });\n          });\n\n        }\n\n        try {\n          // @ts-ignore\n          remotePeerConnection[streamId].onicecandidate = (event: RTCPeerConnectionIceEvent) => {\n            if (debug) console.log('onicecandidate', event);\n            iceCandidateReceived(event, closedStreamId);\n          };\n          // @ts-ignore\n          remotePeerConnection[streamId].ontrack = (event: any) => {\n            if (debug) console.log('onTrack', event);\n            onTrack(event, closedStreamId);\n          };\n\n          // @ts-ignore\n          remotePeerConnection[streamId].ondatachannel = (event: RTCDataChannelEvent) => {\n            initDataChannel(streamId, event.channel);\n          };\n\n          if (dataChannelMode === 'publish') {\n            const dataChannelOptions = {\n              ordered: true,\n            };\n            const dataChannelPeer = remotePeerConnection[streamId].createDataChannel(streamId, dataChannelOptions);\n            initDataChannel(streamId, dataChannelPeer);\n          } else if (dataChannelMode === 'play') {\n            // @ts-ignore\n            remotePeerConnection[streamId].ondatachannel = (event: RTCDataChannelEvent) => {\n              initDataChannel(streamId, event.channel);\n            };\n          } else {\n            const dataChannelOptions = {\n              ordered: true,\n            };\n            const dataChannelPeer = remotePeerConnection[streamId].createDataChannel(streamId, dataChannelOptions);\n            initDataChannel(streamId, dataChannelPeer);\n            // @ts-ignore\n            remotePeerConnection[streamId].ondatachannel = (event: RTCDataChannelEvent) => {\n              initDataChannel(streamId, event.channel);\n            };\n          }\n        } catch (err: any) {\n          if (debug) console.error('initPeerConnectionError', err.message);\n        }\n      }\n    },\n    [\n      config,\n      debug,\n      iceCandidateList,\n      iceCandidateReceived,\n      onTrack,\n      playStreamIds,\n      remoteDescriptionSet,\n      remotePeerConnection,\n    ]\n  );\n\n  const gotDescription = useCallback(\n    async (configuration: any, streamId: string) => {\n      try {\n        if (debug) console.log('in gotDescription');\n\n        // const response =\n        await remotePeerConnection[streamId].setLocalDescription(configuration);\n\n        const jsCmd = {\n          command: 'takeConfiguration',\n          streamId,\n          type: configuration.type,\n          sdp: configuration.sdp,\n        };\n\n        if (ws) ws.sendJson(jsCmd);\n      } catch (err: any) {\n        if (debug) console.log('gotDescriptionError', err);\n      }\n    },\n    [debug, remotePeerConnection, ws]\n  );\n\n  const startPublishing = useCallback(\n    async (streamId: string) => {\n      try {\n        if (debug) console.log('in start publishing');\n\n        await initPeerConnection(streamId, 'publish');\n        const configuration = await remotePeerConnection[streamId].createOffer(\n          config\n        );\n        await gotDescription(configuration, streamId);\n      } catch (err: any) {\n        if (debug) console.log('startPublishing error', err.message, err.stack);\n      }\n    },\n    [config, debug, gotDescription, initPeerConnection, remotePeerConnection]\n  );\n\n  const addIceCandidate = useCallback(\n    async (streamId: string, candidate: any) => {\n      try {\n        if (debug) console.log('in addIceCandidate');\n        if (debug) console.debug(`addIceCandidate ${streamId}`);\n        if (debug) console.debug('candidate', candidate);\n        await remotePeerConnection[streamId].addIceCandidate(candidate);\n      } catch (err) {}\n    },\n    [debug, remotePeerConnection]\n  );\n\n  const takeConfiguration = useCallback(\n    async (streamId: any, configuration: string, typeOfConfiguration: string , idMap?:string) => {\n      const type = typeOfConfiguration;\n      var conf = configuration;\n      conf = conf.replace(\"a=extmap:13 urn:3gpp:video-orientation\\r\\n\", \"\");\n      const isTypeOffer = type === 'offer';\n      idMapping[streamId] = idMap;\n\n      if (debug) console.log('in takeConfiguration');\n      let dataChannelMode: 'publish' | 'play' = 'publish';\n      if (isTypeOffer) {\n        dataChannelMode = 'play';\n      }\n      await initPeerConnection(streamId, dataChannelMode);\n      try {\n        await remotePeerConnection[streamId].setRemoteDescription(\n          new RTCSessionDescription({\n            sdp: conf,\n            type,\n          })\n        );\n        remoteDescriptionSet[streamId] = true;\n        const { length } = Object.keys(iceCandidateList[streamId]);\n        for (let i = 0; i < length; i++) {\n          await addIceCandidate(streamId, iceCandidateList[streamId][i]);\n        }\n        iceCandidateList[streamId] = [];\n        if (isTypeOffer) {\n          const configur = await remotePeerConnection[streamId].createAnswer(\n\n          );\n          await gotDescription(configur, streamId);\n        }\n      } catch (error: any) {\n        if (\n          error.toString().indexOf('InvalidAccessError') > -1 ||\n          error.toString().indexOf('setRemoteDescription') > -1\n        ) {\n          /**\n           * This error generally occurs in codec incompatibility.\n           * AMS for a now supports H.264 codec. This error happens when some browsers try to open it from VP8.\n           */\n          if (callbackError) callbackError('notSetRemoteDescription');\n        }\n      }\n    },\n    [\n      addIceCandidate,\n      callbackError,\n      debug,\n      gotDescription,\n      iceCandidateList,\n      initPeerConnection,\n      remoteDescriptionSet,\n      remotePeerConnection,\n    ]\n  );\n\n  const takeCandidate = useCallback(\n    // @ts-ignore\n    async (idOfTheStream: string, tmpLabel, tmpCandidate, sdpMid) => {\n      if (debug) console.log('in takeCandidate');\n\n      const streamId = idOfTheStream;\n      const label = tmpLabel;\n      const candidateSdp = tmpCandidate;\n\n      const candidate = new RTCIceCandidate({\n        sdpMLineIndex: label,\n        candidate: candidateSdp,\n        sdpMid,\n      });\n\n      await initPeerConnection(streamId, 'peer');\n\n      if (remoteDescriptionSet[streamId] === true) {\n        await addIceCandidate(streamId, candidate);\n      } else {\n        if (debug)\n          console.debug(\n            'Ice candidate is added to list because remote description is not set yet'\n          );\n        const index = iceCandidateList[streamId].findIndex(\n          (i) => JSON.stringify(i) === JSON.stringify(candidate)\n        );\n        if (index === -1) {\n          const keys = Object.keys(candidate);\n          for (const key in keys) {\n            // @ts-ignore\n            if (candidate[key] === undefined || candidate[key] === '') {\n              // @ts-ignore\n              candidate[key] = null;\n            }\n          }\n          iceCandidateList[streamId].push(candidate);\n        }\n      }\n    },\n    [\n      addIceCandidate,\n      debug,\n      iceCandidateList,\n      initPeerConnection,\n      remoteDescriptionSet,\n    ]\n  );\n\n  var ws: any = useRef(new WebSocket(url)).current;\n\n  ws.sendJson = (dt: any) => {\n    ws.send(JSON.stringify(dt));\n  };\n\n  useEffect(() => {\n    ws.onopen = () => {\n      if (debug) console.log('web socket opened !');\n      callback.call(adaptorRef.current, 'initiated');\n      // connection opened\n\n      getDevices();\n\n      if (!onlyDataChannel) {\n        mediaDevices.getUserMedia(mediaConstraints)\n          .then((stream: any) => {\n            // Got stream!\n            if (debug) console.log('got stream');\n\n            localStream.current = stream;\n            if (debug) console.log('in stream', localStream.current);\n          })\n          .catch((error: any) => {\n            // Log error\n            if (debug) console.log('got error', error , mediaConstraints);\n          });\n      } else {\n        if (debug) console.log('only data channel');\n      }\n      setPingTimer();\n    };\n\n    ws.onmessage = (e: any) => {\n      // a message was received\n      const data = JSON.parse(e.data);\n      if (debug) console.log(' onmessage', data);\n\n      switch (data.command) {\n        case 'start':\n          // start  publishing\n          startPublishing(data.streamId);\n          break;\n        case 'takeCandidate':\n          //console.log(' in takeCandidate', data);\n          takeCandidate(data.streamId, data.label, data.candidate, data.id);\n          break;\n        case 'takeConfiguration':\n          takeConfiguration(data.streamId, data.sdp, data.type,data.idMapping);\n          break;\n        case 'stop':\n          if (debug) console.log(' in stop', data);\n          closePeerConnection(data.streamId);\n          break;\n        case 'error':\n          if (debug) console.log(' in error', data);\n          if (callbackError) {\n            callbackError(data.definition, data);\n          }\n          break;\n        case 'notification':\n          if (debug) console.log(' in notification', data);\n\n          if (adaptorRef.current)\n            callback.call(adaptorRef.current, data.definition, data);\n          break;\n        case 'roomInformation':\n          if (debug) console.log(' in roomInformation', data);\n          callback.call(adaptorRef.current, data.command, data);\n          break;\n        case 'pong':\n          if (debug) console.log(' in pong', data);\n          break;\n        case 'streamInformation':\n          if (debug) console.log(' in streamInformation', data);\n          callback.call(adaptorRef.current, data.command, data);\n          break;\n        case 'trackList':\n          if (debug) console.log(' in trackList', data);\n          callback.call(adaptorRef.current, data.command, data);\n          break;\n        case 'connectWithNewId':\n          if (debug) console.log(' in connectWithNewId', data);\n          callback.call(adaptorRef.current, data.command, data);\n          break;\n        case 'peerMessageCommand':\n          if (debug) console.log(' in peerMessageCommand', data);\n          callback.call(adaptorRef.current, data.command, data);\n          break;\n        default:\n          if (debug) console.log(' in default', data);\n          callback.call(adaptorRef.current, data.command, data);\n          break;\n      }\n    };\n\n    ws.onerror = (e: any) => {\n      // an error occurred\n      clearPingTimer();\n      if (debug) console.log(e.message);\n    };\n\n    ws.onclose = (e: any) => {\n      // connection closed\n      clearPingTimer();\n      if (debug) console.log(e.code, e.reason);\n    };\n  }, [\n    callback,\n    callbackError,\n    closePeerConnection,\n    config,\n    debug,\n    mediaConstraints,\n    startPublishing,\n    takeCandidate,\n    takeConfiguration,\n    ws,\n  ]);\n\n  const publish = useCallback(\n    (\n      streamId: string,\n      token?: string,\n      subscriberId?: string,\n      subscriberCode?: string,\n      streamName?: string,\n      mainTrack?:string,\n      metaData?:string\n    ) => {\n      let data = {} as any;\n      if (onlyDataChannel) {\n        data = {\n          command: 'publish',\n          streamId: streamId,\n          token: token,\n          subscriberId: typeof subscriberId !== undefined ? subscriberId : '',\n          subscriberCode: typeof subscriberCode !== undefined ? subscriberCode : '',\n          video: false,\n          audio: false,\n        };\n      } else {\n        if (!localStream.current) return;\n\n        let [video, audio] = [false, false];\n\n        // @ts-ignore\n        video = localStream.current.getVideoTracks().length > 0;\n        // @ts-ignore\n        audio = localStream.current.getAudioTracks().length > 0;\n\n        data = {\n          command: 'publish',\n          streamId,\n          token,\n          subscriberId: typeof subscriberId !== undefined ? subscriberId : '',\n          subscriberCode: typeof subscriberCode !== undefined ? subscriberCode : '',\n          streamName,\n          mainTrack,\n          video,\n          audio,\n          metaData\n        };\n      }\n\n      if (ws) ws.sendJson(data);\n    },\n    [ws]\n  );\n\n  //play\n  const play = useCallback(\n    (streamId: string, token?: string, room?: string , enableTracks?:MediaStreamTrack[],subscriberId?:string, subscriberCode?:string ,metaData?:string ) => {\n      playStreamIds.push(streamId);\n      const data = {\n        command: 'play',\n        streamId,\n        token,\n        room,\n        enableTracks,\n        subscriberId: typeof subscriberId !== undefined ? subscriberId : '',\n        subscriberCode: typeof subscriberCode !== undefined ? subscriberCode : '',\n        viewerInfo: typeof metaData !== undefined && metaData != null ? metaData : \"\"\n      };\n\n      if (token) {\n        data.token = token;\n      }\n\n      if (ws) ws.sendJson(data);\n    },\n    [playStreamIds, ws]\n  );\n\n  const stop = useCallback(\n    (streamId: any) => {\n      closePeerConnection(streamId);\n\n      const data = {\n        command: 'stop',\n        streamId: streamId,\n      };\n      if (ws) ws.sendJson(data);\n    },\n    [ws]\n  );\n\n  const join = useCallback(\n    (streamId: string) => {\n      const data = {\n        command: 'join',\n        streamId,\n      };\n      if (ws) ws.sendJson(data);\n    },\n    [ws]\n  );\n\n  const leave = useCallback(\n    (streamId: string) => {\n      const data = {\n        command: 'leave',\n        streamId,\n      };\n      if (ws) ws.sendJson(data);\n    },\n    [ws]\n  );\n\n  const muteLocalMic = useCallback(() => {\n    if (localStream.current) {\n      // @ts-ignore\n      localStream.current.getAudioTracks().forEach((track) => {\n        track.enabled = false;\n      });\n    }\n  }, [localStream]);\n\n  const unmuteLocalMic = useCallback(() => {\n    if (localStream.current) {\n      // @ts-ignore\n      localStream.current.getAudioTracks().forEach((track) => {\n        track.enabled = true;\n      });\n    }\n  }, [localStream]);\n\n  const setLocalMicVolume = useCallback((volume: number) => {\n    if (localStream.current) {\n      // @ts-ignore\n      localStream.current.getAudioTracks().forEach((track) => {\n        track._setVolume(volume);\n      });\n    }\n  }, [localStream]);\n\n  const setRemoteAudioVolume = useCallback((volume: number, streamId: string, roomName: string|undefined) => {\n    console.log(\"Setting remote mic\")\n    // @ts-ignore\n    if (typeof roomName != 'undefined' && remotePeerConnection[roomName]) {\n      remotePeerConnection[roomName]._remoteStreams.forEach((stream) => {\n        let audioTrackID = \"ARDAMSa\" + streamId;\n        let track = stream.getTrackById(audioTrackID);\n        if (track) {\n          track._setVolume(volume);\n        }\n      });\n    } else if(remotePeerConnection[streamId]) {\n      remotePeerConnection[streamId]._remoteStreams.forEach((stream) => {\n        let audioTrackID = \"ARDAMSa\" + streamId;\n        let track = stream.getTrackById(audioTrackID);\n        if (track) {\n          track._setVolume(volume);\n        }\n      });\n    }\n  }, [remotePeerConnection]);\n\n  const muteRemoteAudio = useCallback((streamId: string, roomName: string|undefined) => {\n    console.log(\"Muting remote mic\")\n    // @ts-ignore\n    if (typeof roomName != 'undefined' && remotePeerConnection[roomName]) {\n      remotePeerConnection[roomName]._remoteStreams.forEach((stream) => {\n        let audioTrackID = \"ARDAMSa\" + streamId;\n        let track = stream.getTrackById(audioTrackID);\n        if (track) {\n          track.enabled = false;\n        }\n      });\n    } else if(remotePeerConnection[streamId]) {\n      remotePeerConnection[streamId]._remoteStreams.forEach((stream) => {\n        let audioTrackID = \"ARDAMSa\" + streamId;\n        let track = stream.getTrackById(audioTrackID);\n        if (track) {\n          track.enabled = false;\n        }\n      });\n    }\n  }, [remotePeerConnection]);\n\n  const unmuteRemoteAudio = useCallback((streamId: string, roomName: string|undefined) => {\n    console.log(\"Muting remote mic\")\n    // @ts-ignore\n    if (typeof roomName != 'undefined' && remotePeerConnection[roomName]) {\n      remotePeerConnection[roomName]._remoteStreams.forEach((stream) => {\n        let audioTrackID = \"ARDAMSa\" + streamId;\n        let track = stream.getTrackById(audioTrackID);\n        if (track) {\n          track.enabled = true;\n        }\n      });\n    } else if(remotePeerConnection[streamId]) {\n      remotePeerConnection[streamId]._remoteStreams.forEach((stream) => {\n        let audioTrackID = \"ARDAMSa\" + streamId;\n        let track = stream.getTrackById(audioTrackID);\n        if (track) {\n          track.enabled = true;\n        }\n      });\n    }\n  }, [remotePeerConnection]);\n\n  const getRoomInfo = useCallback(\n    (room: string, streamId?: string) => {\n      var data = {\n        command: 'getRoomInfo',\n        streamId,\n        room,\n      };\n      if (ws) ws.sendJson(data);\n    },\n    [ws]\n  );\n  const setPingTimer = useCallback(() => {\n    pingTimer = setInterval(()=>{\n      if(ws != null)\n      ws.sendJson({\n        command: 'ping',\n      });\n    },3000);\n  },[]);\n\n  const clearPingTimer = useCallback(() => {\n    if (pingTimer != -1) {\n      if (debug) {\n          console.log(\"Clearing ping message timer\");\n      }\n      clearInterval(pingTimer);\n      pingTimer = -1;\n    }\n  },[]);\n\n  //Data Channel\n  const peerMessage = useCallback(\n    (streamId: string, definition: any, data: any) => {\n      const jsCmd = {\n        command: 'peerMessageCommand',\n        streamId: streamId,\n        definition: definition,\n        data: data,\n      };\n      if (ws) ws.sendJson(jsCmd);\n    },\n    [ws]\n  );\n\n  const getDevices = useCallback( async () => {\n    var deviceArray = new Array();\n\n    try {\n      const devices = await mediaDevices.enumerateDevices();\n      // @ts-ignore\n      devices.map( device => {\n        deviceArray.push(device);\n      } );\n\n      callback.call(adaptorRef.current, 'available_devices', deviceArray);\n    } catch (err: any) {\n      console.log(\"Cannot get devices -> error: \" + err);\n    }\n    // @ts-ignore\n    mediaDevices.ondevicechange = async () => {\n      console.log(\"Device change event\")\n      getDevices();\n    };\n\n    return deviceArray;\n\n  }, [callback]);\n\n  const sendData = useCallback(\n    (streamId: string, message: string) => {\n      // @ts-ignore\n      const dataChannel = remotePeerConnection[streamId].dataChannel;\n      dataChannel.send(message);\n      if (debug) console.log(' send message in server', message);\n    },\n    [ws]\n  );\n\n  const turnOffLocalCamera = useCallback(() => {\n    if (localStream.current) {\n      // @ts-ignore\n      localStream.current.getVideoTracks().forEach((track) => {\n        track.enabled = false;\n      });\n    }\n  }, []);\n\n  const turnOnLocalCamera = useCallback(() => {\n    if (localStream.current) {\n      // @ts-ignore\n      localStream.current.getVideoTracks().forEach((track) => {\n        track.enabled = true;\n      });\n    }\n  }, []);\n\n  const turnOffRemoteCamera = useCallback((streamId: string, roomName: string|undefined) => {\n    console.log(\"Turning off remote camera\")\n    // @ts-ignore\n    if (typeof roomName != 'undefined' && remotePeerConnection[roomName]) {\n      remotePeerConnection[roomName]._remoteStreams.forEach((stream) => {\n        let videoTrackID = \"ARDAMSv\" + streamId;\n        let track = stream.getTrackById(videoTrackID);\n        if (track) {\n          track.enabled = false;\n        }\n      });\n    } else if(remotePeerConnection[streamId]) {\n      remotePeerConnection[streamId]._remoteStreams.forEach((stream) => {\n        let videoTrackID = \"ARDAMSv\" + streamId;\n        let track = stream.getTrackById(videoTrackID);\n        if (track) {\n          track.enabled = false;\n        }\n      });\n    }\n  }, [remotePeerConnection]);\n\n  const turnOnRemoteCamera = useCallback((streamId: string, roomName: string|undefined) => {\n    console.log(\"Turning on remote camera\")\n    // @ts-ignore\n    if (typeof roomName != 'undefined' && remotePeerConnection[roomName]) {\n      remotePeerConnection[roomName]._remoteStreams.forEach((stream) => {\n        let videoTrackID = \"ARDAMSv\" + streamId;\n        let track = stream.getTrackById(videoTrackID);\n        if (track) {\n          track.enabled = true;\n        }\n      });\n    } else if(remotePeerConnection[streamId]) {\n      remotePeerConnection[streamId]._remoteStreams.forEach((stream) => {\n        let videoTrackID = \"ARDAMSv\" + streamId;\n        let track = stream.getTrackById(videoTrackID);\n        if (track) {\n          track.enabled = true;\n        }\n      });\n    }\n  }, [remotePeerConnection]);\n\n  const switchCamera = useCallback(() => {\n    if (localStream.current) {\n      // @ts-ignore\n      localStream.current.getVideoTracks().forEach((track) => {\n        track._switchCamera();\n      });\n    }\n  }, [localStream]);\n\n  //adaptor ref\n  useEffect(() => {\n    adaptorRef.current = {\n      publish,\n      play,\n      stop,\n      join,\n      leave,\n      getRoomInfo,\n      initPeerConnection,\n      localStream,\n      peerMessage,\n      sendData,\n      muteLocalMic,\n      unmuteLocalMic,\n      setLocalMicVolume,\n      setRemoteAudioVolume,\n      muteRemoteAudio,\n      unmuteRemoteAudio,\n      turnOffLocalCamera,\n      turnOnLocalCamera,\n      turnOffRemoteCamera,\n      turnOnRemoteCamera,\n      switchCamera,\n      getDevices,\n    };\n  }, [\n    publish,\n    play,\n    stop,\n    localStream,\n    join,\n    leave,\n    getRoomInfo,\n    initPeerConnection,\n    peerMessage,\n    sendData,\n    muteLocalMic,\n    unmuteLocalMic,\n    setLocalMicVolume,\n    setRemoteAudioVolume,\n    muteRemoteAudio,\n    unmuteRemoteAudio,\n    turnOffLocalCamera,\n    turnOnLocalCamera,\n    turnOffRemoteCamera,\n    turnOnRemoteCamera,\n    switchCamera,\n    getDevices,\n  ]);\n\n  return {\n    publish,\n    play,\n    stop,\n    localStream,\n    join,\n    leave,\n    getRoomInfo,\n    initPeerConnection,\n    peerMessage,\n    sendData,\n    setLocalMicVolume,\n    setRemoteAudioVolume,\n    muteLocalMic,\n    unmuteLocalMic,\n    muteRemoteAudio,\n    unmuteRemoteAudio,\n    turnOffLocalCamera,\n    turnOnLocalCamera,\n    turnOffRemoteCamera,\n    turnOnRemoteCamera,\n    switchCamera,\n    getDevices,\n  } as Adaptor;\n} // useAntmedia fn end\n\nexport function rtc_view(\n  stream: any,\n  customStyles: any = { width: '70%', height: '50%', alignSelf: 'center' },\n  objectFit: any = 'cover'\n) {\n  if(stream instanceof MediaStreamTrack ){\n    let mediaStream = new MediaStream(undefined);\n    mediaStream.addTrack(stream);\n    stream = mediaStream.toURL();\n  }\n  const props = {\n    streamURL: stream,\n    style: customStyles,\n    objectFit: objectFit,\n  };\n\n  // @ts-ignore\n  return <RTCView {...props} />;\n}\n"],"mappings":"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","ignoreList":[]}